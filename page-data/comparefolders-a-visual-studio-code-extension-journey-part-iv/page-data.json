{"componentChunkName":"component---src-components-post-js","path":"/comparefolders-a-visual-studio-code-extension-journey-part-iv/","result":{"data":{"site":{"siteMetadata":{"title":"Moshe Feuchtwanger","social":[{"name":"twitter","url":"https://twitter.com/moshfeu"},{"name":"github","url":"https://github.com/moshfeu"},{"name":"linkedin","url":"https://www.linkedin.com/in/moshfeu/"},{"name":"stackoverflow","url":"https://stackoverflow.com/users/863110/mosh-feu"},{"name":"visualstudiocode","url":"https://marketplace.visualstudio.com/publishers/moshfeu"}]}},"mdx":{"id":"f93d928d-0499-56c2-ab5c-d94f444f88c3","excerpt":"In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"comparefolders-a-visual-studio-code-extension-journey-part-iv\",\n  \"date\": \"2019-09-29T14:02:37.324Z\",\n  \"author\": \"Mosh Feu\",\n  \"title\": \"CompareFolders — a Visual Studio Code extension journey — Part IV\",\n  \"image\": \"0xeKX4RJyX-8sueTl.jpeg\",\n  \"images\": [\"0xeKX4RJyX-8sueTl.jpeg\", \"1a7jbpEvrTNYFQwOO0pgyuQ.png\", \"1SyNphHDTYWiX0ze-97vaJQ.png\"],\n  \"tags\": [\"vscode\", \"vscode-extension\", \"how-to\", \"open-source\"],\n  \"keywords\": [\"vscode\", \"vscode-extension\", \"how-to\", \"open-source\"],\n  \"canonical\": \"https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://medium.com/@moshfeu/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii-77e0467a12f6?source=friends_link&sk=34deefe0a5a41ce97c6197a5f2813e0f\"\n  }), \"last post\"), \", we talked about how to add an icon to the activity bar and \\u201Cattach\\u201D a view to it. How to use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TreeDataProvider\"), \" to present File System like view to show the diffs like files in directories.\"), mdx(\"p\", null, \"Like promised, the post will includes an explanation about the product challenge and how to solve it.\"), mdx(\"h2\", null, \"The Challenge\"), mdx(\"p\", null, \"In the last post, the extension was able to show only single hierarchy of differences. Means if a deep folder has differences the extension wasn\\u2019t be able to show it. This challenge, obviously, is not a vscode extension specifically but I splatted the commits so this refactor will \\u201Cget\\u201D its own commit to isolate the logic and maybe will help to someone else with such task.\"), mdx(\"p\", null, \"Back to the series\\u2019 format \\u2014 vscode extension challenges, the extension should allow the users to refresh the folders view after some change has been made in a file / folder. So we\\u2019ll add a button to the panel\\u2019s \\u201Ctop bar\\u201D and when the user will click on it, the compare logic will run again and will refresh the view. Once the view refreshed, the extension will show an information popup about that.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"674px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"15%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAiUlEQVQI1zWMaxLCIAyEuf+1nKl2ClinoFY6CPJO8A5S1O/HZrPZCUHEEMLrh/PeW2uNMf5PSQk5zacBp9Fo3co55xhjSonUWrXWjJ8p5fN8EfLaPGN8WYSQclUbegfDYVPqPR5vnD2tTTE659oLAgBtQCkFdtk9APawdNpe1APZBOs99/x7avoBKFGd6VtJLJEAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"A “top bar” button in the source control panel\",\n    \"title\": \"A “top bar” button in the source control panel\",\n    \"src\": \"/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png\",\n    \"srcSet\": [\"/static/1d35c479321e2c2a4791725f20c55120/5a46d/1a7jbpEvrTNYFQwOO0pgyuQ.png 300w\", \"/static/1d35c479321e2c2a4791725f20c55120/0a47e/1a7jbpEvrTNYFQwOO0pgyuQ.png 600w\", \"/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png 674w\"],\n    \"sizes\": \"(max-width: 674px) 100vw, 674px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"), mdx(\"em\", {\n    parentName: \"p\"\n  }, \"A \\u201Ctop bar\\u201D button in the source control panel\")), mdx(\"p\", null, \"So\"), mdx(\"h2\", null, \"How to display a button in a view\\u2019s top bar?\"), mdx(\"p\", null, \"In order to display a button we need some steps: We need to add the button as a \\u201Ccontributer\\u201D in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"contributes\"), \" section and specify the command that we want to run when it clicked. Therefore, we need to add that command to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"commands\"), \" section, also in the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"package.json.\"), \" And finally, we need to register that command in the extension\\u2019s activation call.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 1\")), mdx(\"p\", null, \"Add the \\u201Crefresh\\u201D command in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"commands\"), \" section in \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"package.json\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-json\"\n  }), \"\\\"commands\\\": [\\n  ...\\n  {\\n    \\\"title\\\": \\\"Refresh\\\",\\n    \\\"command\\\": \\\"foldersCompare.refresh\\\",\\n    \\\"icon\\\": \\\"resources/refresh.svg\\\"\\n  }\\n]\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 2\")), mdx(\"p\", null, \"Add the \\u201Crefresh\\u201D button in the top bar in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"contributes-&gt;menus\"), \" section in \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"package.json\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-json\"\n  }), \"\\\"contributes\\\": {\\n  ...\\n  \\\"menus\\\": {\\n    \\\"view/title\\\": [{\\n      \\\"command\\\": \\\"foldersCompare.refresh\\\",\\n      \\\"group\\\": \\\"navigation\\\"\\n    }]\\n  },\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"command\"), \" is the key of the command and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"group\"), \" is the place we want to present the button inside the top bar. By default it will be presented under the \\u201Cmore\\u201D menu:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"926px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"18%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAvElEQVQI11WOS27DIBiEff8jVekqUqLaYBxehh+M7YB5ZdEeIaTtJqNvZjGL0XTWGK2UFAIAOONN1lo1z5QyAFNrKSX/U0sNvuIhof6HTZez6KRdR65uyjC9MHDCrq2heuHg5LKtMbvjl5BcfmwIb27dYwrxIP672/d7PyCpNONy1jBOlHJxowyNJBwx5dL8IqZYH2HEhwYG9oInDrZz1hBC2ls04Lv3Kb70lznn8k7b8EO/fH7Mp1P8uj4BR7XOfI9jQlwAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"1SyNphHDTYWiX0ze 97vaJQ\",\n    \"title\": \"1SyNphHDTYWiX0ze 97vaJQ\",\n    \"src\": \"/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png\",\n    \"srcSet\": [\"/static/e08ca02f46109b265fbcd070bb401f39/5a46d/1SyNphHDTYWiX0ze-97vaJQ.png 300w\", \"/static/e08ca02f46109b265fbcd070bb401f39/0a47e/1SyNphHDTYWiX0ze-97vaJQ.png 600w\", \"/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png 926w\"],\n    \"sizes\": \"(max-width: 926px) 100vw, 926px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 3\")), mdx(\"p\", null, \"Register the command in the extension\\u2019s activation call\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"export function activate(context: ExtensionContext) {\\n  ...\\n  commands.registerCommand(REFRESH, foldersCompareProvider.refresh);\\n}\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 4\")), mdx(\"p\", null, \"Finally, we need to implement the \\u201Crefresh\\u201D functionality and ask vscode refresh the view.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"refresh = (): void => {\\n  try {\\n    /*\\n     get (from memory) the current path of the compared folder\\n     and do the comparison again\\n    */\\n    this._diffs = compare(this.workspaceRoot, getComparedPath());\\n    // ask vscode to refresh to view\\n    this._onDidChangeTreeData.fire();\\n    // show a message to the user\\n    window.showInformationMessage('Source refreshed', 'Dismiss');\\n  } catch (error) {\\n    console.log(error);\\n  }\\n}\\n\")), mdx(\"p\", null, \"Notice that the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onDidChangeTreeData.fire\"), \" event shouldn\\u2019t call with arguments, otherwise, none of the functions (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getChildren\"), \" not \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getTreeItem\"), \") will be fired.\"), mdx(\"p\", null, \"Notice also that the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"refresh\"), \" method declared as an arrow function to bind it to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"foldersCompareProvider\"), \" instance. When vscode will invoke that function it will run in the context of the instance (Is that clear enough?)\"), mdx(\"p\", null, \"Finally, we want to show an information message with a \\u201Cdismiss\\u201D button to let them know that the sourced refreshed (in case the change in deep path and not visible in the UI right away)\"), mdx(\"p\", null, \"And this is the result\"), mdx(\"iframe\", {\n    src: \"https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F6208d7IZMpo%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D6208d7IZMpo&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F6208d7IZMpo%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube\",\n    width: \"100%\",\n    height: \"480\"\n  }), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/moshfeu/vscode-compare-folders/tree/ccf0b516b6a9eb9c1590d69580baaede0102582f\"\n  }), \"Source code for this post\")), mdx(\"p\", null, \"Have something to say? I\\u2019ll love to \\uD83D\\uDC42\"));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"comparefolders-a-visual-studio-code-extension-journey-part-iv/","frontmatter":{"canonical":"https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3","title":"CompareFolders — a Visual Studio Code extension journey — Part IV","subtitle":null,"keywords":["vscode","vscode-extension","how-to","open-source"],"tags":["vscode","vscode-extension","how-to","open-source"],"date":"September 29, 2019","image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAF786mSSQP/xAAZEAACAwEAAAAAAAAAAAAAAAABAgADERL/2gAIAQEAAQUCqrXORHrXqpjCxxmO/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAAMRD/2gAIAQEABj8CTKqv/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARMSD/2gAIAQEAAT8hBiLmOE7l3H//2gAMAwEAAgADAAAAENQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QR//EABgQAQEBAQEAAAAAAAAAAAAAAAEAESFx/9oACAEBAAE/EAjhZoOHkFYBADqLwp2yv//Z","aspectRatio":1.7783505154639174,"src":"/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg","srcSet":"/static/959f5fde34fc36b0be57fdeb0e5ff23b/862d9/0xeKX4RJyX-8sueTl.jpg 345w,\n/static/959f5fde34fc36b0be57fdeb0e5ff23b/32c8c/0xeKX4RJyX-8sueTl.jpg 690w,\n/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg 1380w,\n/static/959f5fde34fc36b0be57fdeb0e5ff23b/4e1b9/0xeKX4RJyX-8sueTl.jpg 1844w","sizes":"(max-width: 1380px) 100vw, 1380px"}}}},"childMdxBlogPost":{"imageAlt":null,"imageCaptionLink":null,"imageCaptionText":null,"socialImage":null}},"previous":{"__typename":"MdxBlogPost","id":"e89fcf39-137b-56c2-816c-b830ba2573fe","excerpt":"In the  last post , we talked about how to add a command to the commands palette so the user could interact with the plugin via commands. In…","slug":"/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii/","title":"CompareFolders — a Visual Studio Code extension journey — Part III","date":"September 19, 2019"},"next":{"__typename":"MdxBlogPost","id":"62b5b2ce-df91-574a-ab8a-40838a3caa4b","excerpt":"In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…","slug":"/comparefolders-a-visual-studio-code-extension-journey-part-v/","title":"CompareFolders — a Visual Studio Code extension journey — Part V","date":"October 06, 2019"}},"pageContext":{"id":"0a5c722a-3986-5a6e-bb96-9c9dd555aeab","previousId":"e89fcf39-137b-56c2-816c-b830ba2573fe","nextId":"62b5b2ce-df91-574a-ab8a-40838a3caa4b","maxWidth":1380,"slug":"comparefolders-a-visual-studio-code-extension-journey-part-iv"}},"staticQueryHashes":["2744905544","3090755652","4064581832","511549514","764694655"]}