<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.53442290c273bab4c325.css">:root{--reach-skip-nav:1}[data-reach-skip-nav-link]{border:0;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute}[data-reach-skip-nav-link]:focus{padding:1rem;position:fixed;top:10px;left:10px;background:#fff;z-index:1;width:auto;height:auto;clip:auto}body{font-size:18px;line-height:1.5}body:not(.dark-mode){--dark-sky:#53bde6;--light-sky:#cdfdff;--planet-color:#ffe130;--link-color:#007acc;--text-color:inherit;--planet-emoji:"\1F576\FE0F"}body.dark-mode{--dark-sky:#000;--light-sky:#122627;--planet-color:#fff;--link-color:#ffeb00;--text-color:#fffee9;--planet-emoji:"\1F440"}.header-module--header--2EhlL{--radius:60px;--dim:calc(var(--radius)*2);--position:-10px;background:linear-gradient(var(--dark-sky),var(--light-sky));transition:background .2s ease;color:var(--text-color);overflow:hidden;position:relative}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f{background:radial-gradient(var(--radius) circle at var(--radius) var(--radius),var(--planet-color) 50%,transparent 100%);position:absolute;top:0;right:0;height:var(--dim);width:var(--dim);transition:background,color .2s ease;cursor:pointer;border:0;outline:0;padding:0;font-size:40px;transform:rotate(30deg) translate(10px,-50px);color:transparent}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f:focus,.header-module--header--2EhlL .header-module--toggle-dark--fbF-f:hover{color:#000}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f span:before{content:var(--planet-emoji)}.header-module--header--2EhlL a{color:inherit;box-shadow:none;text-decoration:none;display:inline-flex;align-items:center}.link-module--link--1wSRX{color:var(--link-color);word-break:break-word}.social-nav-module--link--2GvUk{margin:0 5px}.social-nav-module--link--2GvUk svg{width:20px}body.dark-mode .social-nav-module--link--2GvUk svg path{fill:#fff}.footer-module--footer--R2bpz{text-align:center;padding-block:15px;background:#000;box-shadow:0 0 10px #000;color:#b5e853;font-family:monospace}.footer-module--footer--R2bpz:before{content:"";display:block;height:25px;background:radial-gradient(5px circle at 10px 10px,#fe6158 100%,transparent),radial-gradient(5px circle at 27px 10px,#febe2f 100%,transparent),radial-gradient(5px circle at 44px 10px,#28c940 100%,transparent)}.footer-module--footer--R2bpz a,.footer-module--footer--R2bpz a:link,.footer-module--footer--R2bpz a:visited{color:#63c0f5}.layout-module--root--2bezS{display:flex;flex-direction:column;min-height:100vh;color:var(--text-color)}.layout-module--content--15Ymk{flex:1 1;background:linear-gradient(var(--light-sky) calc(100% - 60px),#8ab807 calc(100% - 40px),#563a2c calc(100% - 10px),#563a2c);padding-bottom:30px}.layout-module--content--15Ymk img{max-width:100%}.code-module--line-number-style--2tWK5{display:inline-block;padding-left:1em;padding-right:1em;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.3;text-align:center;position:relative}img+.em-module--em--KE84c,span+.em-module--em--KE84c{display:block;text-align:center;font-size:.9rem;padding-block:4px}</style><meta name="generator" content="Gatsby 2.26.1"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">CompareFolders — a Visual Studio Code extension journey — Part V | Moshe Feuchtwanger</title><link data-react-helmet="true" rel="icon" type="image/png" href="/static/avatar-e981c1fbc840d15a0caabe830fa5674f.png"/><link data-react-helmet="true" rel="canonical" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-v-614014a81efb"/><meta data-react-helmet="true" name="google-site-verification" content="hpJ5hHMHz7pz5hEBUsKSCUaVIZg8rMKiQ86uyqVuFw4"/><meta data-react-helmet="true" name="description" content="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…"/><meta data-react-helmet="true" property="og:title" content="CompareFolders — a Visual Studio Code extension journey — Part V"/><meta data-react-helmet="true" property="og:description" content="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:creator" content="Moshe Feuchtwanger"/><meta data-react-helmet="true" name="twitter:title" content="CompareFolders — a Visual Studio Code extension journey — Part V"/><meta data-react-helmet="true" name="twitter:description" content="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…"/><meta data-react-helmet="true" name="keywords" content="vscode,vscode-extension,how-to,open-source"/><meta data-react-helmet="true" name="og:image" content="https://moshfeu.github.io/static/aa969a2ba00985ac017e465f66572909/a674a/0WLT5eGWMd5Sloyre.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…"/><meta data-react-helmet="true" name="twitter:image" content="https://moshfeu.github.io/static/aa969a2ba00985ac017e465f66572909/a674a/0WLT5eGWMd5Sloyre.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><link href="https://fonts.googleapis.com/css?family=Roboto:wght@300|Open+Sans&amp;display=swap" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-34fb2f5293c22f35b953.js"/><link as="script" rel="preload" href="/framework-a445a942d18bd3dc90d1.js"/><link as="script" rel="preload" href="/app-37ffe6043015bf5ad354.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/commons-3991cdc52c163109ec33.js"/><link as="script" rel="preload" href="/component---src-components-post-js-9ac965f2a77e28f4d22e.js"/><link as="fetch" rel="preload" href="/page-data/comparefolders-a-visual-studio-code-extension-journey-part-v/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090755652.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4064581832.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/511549514.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/764694655.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="1t14ewn">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#282c35);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#007acc);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#1B1F23);--theme-ui-colors-muted:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#00ff00);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#282c35);--theme-ui-colors-prism-background:var(--theme-ui-colors-prism-background,#011627);--theme-ui-colors-prism-comment:var(--theme-ui-colors-prism-comment,#809393);--theme-ui-colors-prism-string:var(--theme-ui-colors-prism-string,#addb67);--theme-ui-colors-prism-var:var(--theme-ui-colors-prism-var,#d6deeb);--theme-ui-colors-prism-number:var(--theme-ui-colors-prism-number,#f78c6c);--theme-ui-colors-prism-constant:var(--theme-ui-colors-prism-constant,#82aaff);--theme-ui-colors-prism-punctuation:var(--theme-ui-colors-prism-punctuation,#c792ea);--theme-ui-colors-prism-className:var(--theme-ui-colors-prism-className,#ffc98b);--theme-ui-colors-prism-tag:var(--theme-ui-colors-prism-tag,#ffa7c4);--theme-ui-colors-prism-boolean:var(--theme-ui-colors-prism-boolean,#ff5874);--theme-ui-colors-prism-property:var(--theme-ui-colors-prism-property,#80cbc4);--theme-ui-colors-prism-namespace:var(--theme-ui-colors-prism-namespace,#b2ccd6);--theme-ui-colors-prism-highlight:var(--theme-ui-colors-prism-highlight,hsla(207,95%,15%,1));color:var(--theme-ui-colors-text,#282c35);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,rgba(255,255,255,0.86));--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#232129);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#D9BAE8);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,rgba(255,255,255,0.86));--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,hsla(0,0%,100%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-modes-dark-highlight,#663399);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);}</style><style data-emotion-css="1rckfa9">*{box-sizing:border-box;}body{margin:0;font-family:Open Sans,Roboto,system-ui,sans-serif;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="1awr4tz">.css-1awr4tz{font-family:Open Sans,Roboto,system-ui,sans-serif;}</style><div class="layout-module--root--2bezS css-1awr4tz"><header class="header-module--header--2EhlL"><style data-emotion-css="f7co1v">.css-f7co1v{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-f7co1v"><style data-emotion-css="rsd53u">.css-rsd53u{margin-top:0;margin-bottom:0;font-size:24px;}</style><div class="css-rsd53u"><a href="/"><style data-emotion-css="1emx3y6">.css-1emx3y6{margin-right:8px;margin-bottom:0;width:48px;min-width:48px;border-radius:99999px;}</style><img src="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png" srcSet="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png 1x,
/static/e981c1fbc840d15a0caabe830fa5674f/e5b88/avatar.png 1.5x,
/static/e981c1fbc840d15a0caabe830fa5674f/88b72/avatar.png 2x" alt="Moshe Feuchtwanger" class="css-1emx3y6"/>Moshe Feuchtwanger</a></div></div><button aria-label="Toggle Dark Mode" class="header-module--toggle-dark--fbF-f"><span></span></button></header><div class="layout-module--content--15Ymk"><style data-emotion-css="1in33uw">.css-1in33uw{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;padding-bottom:32px;}</style><div class="css-1in33uw"><main><article><header><h1 class="css-0">CompareFolders — a Visual Studio Code extension journey — Part V</h1><style data-emotion-css="1h1xv8c">.css-1h1xv8c{font-size:14px;margin-top:-16px;margin-bottom:16px;}</style><style data-emotion-css="dv5tmu">.css-dv5tmu{font-size:14px;margin-top:-16px;margin-bottom:16px;}.css-dv5tmu code{font-size:inherit;}</style><p class="css-dv5tmu">October 06, 2019</p><div class="css-0"><a href="/tag/vscode"><style data-emotion-css="b8nnxg">.css-b8nnxg{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary,#007acc);margin-left:0;}</style><div class="css-b8nnxg">vscode</div></a><a href="/tag/vscode-extension"><style data-emotion-css="ugeaf6">.css-ugeaf6{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary,#007acc);margin-left:4px;}</style><div class="css-ugeaf6">vscode-extension</div></a><a href="/tag/how-to"><div class="css-ugeaf6">how-to</div></a><a href="/tag/open-source"><div class="css-ugeaf6">open-source</div></a></div></header><style data-emotion-css="164r41r">.css-164r41r{margin-top:8px;}</style><div class="css-164r41r"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:56.231884057971016%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAF786mSSQP/xAAZEAACAwEAAAAAAAAAAAAAAAABAgADERL/2gAIAQEAAQUCqrXORHrXqpjCxxmO/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAAMRD/2gAIAQEABj8CTKqv/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARMSD/2gAIAQEAAT8hBiLmOE7l3H//2gAMAwEAAgADAAAAENQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QR//EABgQAQEBAQEAAAAAAAAAAAAAAAEAESFx/9oACAEBAAE/EAjhZoOHkFYBADqLwp2yv//Z" alt="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/aa969a2ba00985ac017e465f66572909/862d9/0WLT5eGWMd5Sloyre.jpg 345w,
/static/aa969a2ba00985ac017e465f66572909/32c8c/0WLT5eGWMd5Sloyre.jpg 690w,
/static/aa969a2ba00985ac017e465f66572909/a674a/0WLT5eGWMd5Sloyre.jpg 1380w,
/static/aa969a2ba00985ac017e465f66572909/4e1b9/0WLT5eGWMd5Sloyre.jpg 1844w" sizes="(max-width: 1380px) 100vw, 1380px" /><img loading="lazy" sizes="(max-width: 1380px) 100vw, 1380px" srcset="/static/aa969a2ba00985ac017e465f66572909/862d9/0WLT5eGWMd5Sloyre.jpg 345w,
/static/aa969a2ba00985ac017e465f66572909/32c8c/0WLT5eGWMd5Sloyre.jpg 690w,
/static/aa969a2ba00985ac017e465f66572909/a674a/0WLT5eGWMd5Sloyre.jpg 1380w,
/static/aa969a2ba00985ac017e465f66572909/4e1b9/0WLT5eGWMd5Sloyre.jpg 1844w" src="/static/aa969a2ba00985ac017e465f66572909/a674a/0WLT5eGWMd5Sloyre.jpg" alt="In the  last post , we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar…" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></div><section><style data-emotion-css="1ek8oqb">.css-1ek8oqb code{font-size:inherit;}</style><p class="css-1ek8oqb">In the <a class="link-module--link--1wSRX" href="https://medium.com/@moshfeu/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3?source=friends_link&amp;sk=e21b42e8c4de1a447fcac3464b37ebf8" target="_blank" rel="noopener noreferrer">last post</a>, we talked about how to add a button to a panel’s top bar — either in the “more” menu or as icon button in the top bar itself. Also we learned how to use <style data-emotion-css="1lcx0oi">.css-1lcx0oi{border-radius:0.3em;color:var(--theme-ui-colors-secondary,#1B1F23);background-color:var(--theme-ui-colors-highlight,#00ff00);padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-1lcx0oi">_onDidChangeTreeData.fire()</code> in <code class="css-1lcx0oi">TreeDataProvider</code> class to refresh the view.</p><p class="css-1ek8oqb">Like promised, the post will includes an explanation about the product challenge and how to solve it.</p><style data-emotion-css="h7w91b">.css-h7w91b{pointer-events:painted;}.css-h7w91b a{visibility:hidden;}.css-h7w91b:hover a{visibility:visible;}</style><h2 class="css-h7w91b"><style data-emotion-css="vvm4x1">.css-vvm4x1{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary,#007acc);}</style><a href="#undefined" aria-label="The challenge" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The challenge</h2><p class="css-1ek8oqb">The extension is supporting (currently) only comparing between a <a class="link-module--link--1wSRX" href="https://stackoverflow.com/a/57134632/863110" target="_blank" rel="noopener noreferrer">single workspace folder</a> (or just a folder), and a folder that the user chosen. Which means that if there is not folder in the workspace (just open a new window of vscode) or if it has more than one folder the <a class="link-module--link--1wSRX" href="https://medium.com/@moshfeu/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii-77e0467a12f6#d5a5" target="_blank" rel="noopener noreferrer">activity icon</a> and the <a class="link-module--link--1wSRX" href="https://medium.com/@moshfeu/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii-77e0467a12f6#3f30" target="_blank" rel="noopener noreferrer">view</a> shouldn’t be visible and vice-versa.</p><p class="css-1ek8oqb">The challenge is even bigger because this can be changed without closing the window, therefor, vscode will not re-activate the extension. Which means that the extension need to “listen” to this change.</p><p class="css-1ek8oqb">So, let’s break it to some steps.</p><ol class="css-0"><li class="css-1ek8oqb">Now the extension need to be activate just when the vscode window is opened but not only when the extension’s view is visible. That’s because we need to check if the workspace has exactly one folder <strong class="css-0">before</strong> it shows the view. In order to do this, the <code class="css-1lcx0oi">[activationEvents</code>](<a class="link-module--link--1wSRX" href="https://code.visualstudio.com/api/references/activation-events" target="_blank" rel="noopener noreferrer">https://code.visualstudio.com/api/references/activation-events</a>) now should be <code class="css-1lcx0oi">*</code></li></ol><p class="css-1ek8oqb"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px">
      <a class="link-module--link--1wSRX" href="/static/d9871beff4c17c937d8460316b970b41/46115/1rwXn02dUYwuzmk0e5d9KcA.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:10.999999999999998%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsSAAALEgHS3X78AAAAcElEQVQI1w3KSw7DIAwA0dz/cN00lZpFUhKbX8AYBJgsy2akJ81SEXhb+fum9ZW3Tz5VRyWohr6asc6nWEIoUXuFdtdWgd7NDbYmEl4a8TAw12GuWYFfh6PjIXA+3vVWQr59Dq6mKESj0FNoZJJJ/gPbB22TH/YQFQAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="1rwXn02dUYwuzmk0e5d9KcA" title="1rwXn02dUYwuzmk0e5d9KcA" src="/static/d9871beff4c17c937d8460316b970b41/c1b63/1rwXn02dUYwuzmk0e5d9KcA.png" srcSet="/static/d9871beff4c17c937d8460316b970b41/5a46d/1rwXn02dUYwuzmk0e5d9KcA.png 300w,/static/d9871beff4c17c937d8460316b970b41/0a47e/1rwXn02dUYwuzmk0e5d9KcA.png 600w,/static/d9871beff4c17c937d8460316b970b41/c1b63/1rwXn02dUYwuzmk0e5d9KcA.png 1200w,/static/d9871beff4c17c937d8460316b970b41/46115/1rwXn02dUYwuzmk0e5d9KcA.png 1290w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><ol start="2" class="css-0"><li class="css-1ek8oqb">To show / hide a view based on condition, a <code class="css-1lcx0oi">view</code> has a configuration property called <code class="css-1lcx0oi">[when</code>](<a class="link-module--link--1wSRX" href="https://code.visualstudio.com/api/extension-guides/tree-view#tree-view" target="_blank" rel="noopener noreferrer">https://code.visualstudio.com/api/extension-guides/tree-view#tree-view</a>). For example:</li></ol><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;contributes&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;views&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;package-explorer&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">5</span><span class="token plain">        </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;id&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;nodeDependencies&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">6</span><span class="token plain">        </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Node Dependencies&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">7</span><span class="token plain">        </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;when&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;explorer&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">8</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">9</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">10</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">11</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb">So the view will be visible only when the <code class="css-1lcx0oi">explorer</code> panel is visible.</p><p class="css-1ek8oqb">But what if we need a custom when clause? In our case, if the workspace has exactly one folder? (If you already know the answer, good for you 😀)</p><h2 class="css-h7w91b"><a href="#undefined" aria-label="How to create a custom ,[object Object], clause?" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to create a custom <code class="css-1lcx0oi">when</code> clause?</h2><p class="css-1ek8oqb">Or, how to show / hide views, command menus and all the other UI components that have the <code class="css-1lcx0oi">when</code> option in <em class="em-module--em--KE84c">package.json</em>?</p><p class="css-1ek8oqb">In order to understand that, we need to understand what is the <code class="css-1lcx0oi">editorLangId </code>or <code class="css-1lcx0oi">isInDiffEditor</code>, or any other clauses in the <a class="link-module--link--1wSRX" href="https://code.visualstudio.com/docs/getstarted/keybindings#_contexts" target="_blank" rel="noopener noreferrer">list</a>.</p><p class="css-1ek8oqb">Well, vscode has context variables. <code class="css-1lcx0oi">isInDiffEditor</code> is <code class="css-1lcx0oi">true</code> when the current editor is.. well.. diff editor (the side by side one, yes?) and <code class="css-1lcx0oi">false</code> in all other cases.</p><p class="css-1ek8oqb">The extension has the power to create its own context variable. Well, don’t search this API in the docs.. It’s not there. Yah, I know.. There is an <a class="link-module--link--1wSRX" href="https://github.com/Microsoft/vscode/issues/46445" target="_blank" rel="noopener noreferrer">open issue on Github</a> about that.</p><p class="css-1ek8oqb">Anyway, there is an API to create a custom context variable</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token plain">commands</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">executeCommand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;setContext&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;[variableName]&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">variableValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></pre></div><p class="css-1ek8oqb">In our case, the extension needs to check both on its <code class="css-1lcx0oi">activation</code> and when the workspace folders changed (by listening to <code class="css-1lcx0oi">workspace.onDidChangeWorkspaceFolders)</code> if the workspace has exactly one folder. If so, the extension will set a context variable <code class="css-1lcx0oi">workspaceHasOneFolder</code> to <code class="css-1lcx0oi">true</code> and <code class="css-1lcx0oi">false</code> if not. Then, we could use that variable in the <em class="em-module--em--KE84c">package.json</em></p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;views&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;foldersCompare&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;id&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;foldersCompareAppService&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">5</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Compare&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">6</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;when&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;workspaceHasOneFolder&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">7</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">8</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb">and Voilà</p><p class="css-1ek8oqb"><img src="/72f411bf7c69c20abfd1a67fa4835000/1oCKpmprnWTK4LstdApAeRQ.gif" alt="Show activity bar icon only if workspace has only one folder" class="css-0"/><em class="em-module--em--KE84c">Show activity bar icon only if workspace has only one folder</em></p><p class="css-1ek8oqb">After we saw all this I’ve to admit, I cheated.. there is an appropriate <code class="css-1lcx0oi">when</code> clause — <code class="css-1lcx0oi">workspaceFolderCount</code> so the condition will be <code class="css-1lcx0oi">workspaceFolderCount == 1</code> but I wanted to show how to deal with custom context variable. I hope to find a different <strong class="css-0">real</strong> example.</p><p class="css-1ek8oqb"><a class="link-module--link--1wSRX" href="https://github.com/moshfeu/vscode-compare-folders/commit/26233117ae445c25a2bcf2e427e0b3991923ca7b" target="_blank" rel="noopener noreferrer">Source code for this post</a> (short this time)</p><p class="css-1ek8oqb">Have something to say? I’ll love to 👂</p><a class="link-module--link--1wSRX" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-v-614014a81efb" target="_blank" rel="noopener noreferrer">Original Post</a></section></article></main></div></div><footer class="footer-module--footer--R2bpz"><style data-emotion-css="1jso6df">.css-1jso6df{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:8px;}</style><style data-emotion-css="5l21x5">.css-5l21x5{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:8px;}</style><ul class="css-5l21x5"><li><a rel="prev" href="/comparefolders-a-visual-studio-code-extension-journey-part-iv/">← <!-- -->CompareFolders — a Visual Studio Code extension journey — Part IV</a></li><li><a rel="next" href="/how-to-post-code-snippet-and-run-it/">How to post code snippet and run it<!-- --> →</a></li></ul>© <!-- -->2021<!-- --> - Moshe Feuchtwander</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-118358576-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-118358576-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/comparefolders-a-visual-studio-code-extension-journey-part-v/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0d7e88a7db3bbb3eb0cb.js"],"app":["/app-37ffe6043015bf5ad354.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-2354108c7c1e6ea82115.js"],"component---src-components-post-js":["/component---src-components-post-js-9ac965f2a77e28f4d22e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-374e405cea89028be59d.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-0d85a378afe990b7f8c3.js"]};/*]]>*/</script><script src="/polyfill-0d7e88a7db3bbb3eb0cb.js" nomodule=""></script><script src="/component---src-components-post-js-9ac965f2a77e28f4d22e.js" async=""></script><script src="/commons-3991cdc52c163109ec33.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-37ffe6043015bf5ad354.js" async=""></script><script src="/framework-a445a942d18bd3dc90d1.js" async=""></script><script src="/webpack-runtime-34fb2f5293c22f35b953.js" async=""></script></body></html>