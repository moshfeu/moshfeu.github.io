<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.53442290c273bab4c325.css" id="gatsby-global-css">:root{--reach-skip-nav:1}[data-reach-skip-nav-link]{border:0;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute}[data-reach-skip-nav-link]:focus{padding:1rem;position:fixed;top:10px;left:10px;background:#fff;z-index:1;width:auto;height:auto;clip:auto}body{font-size:18px;line-height:1.5}body:not(.dark-mode){--dark-sky:#53bde6;--light-sky:#cdfdff;--planet-color:#ffe130;--link-color:#007acc;--text-color:inherit;--planet-emoji:"\1F576\FE0F"}body.dark-mode{--dark-sky:#000;--light-sky:#122627;--planet-color:#fff;--link-color:#ffeb00;--text-color:#fffee9;--planet-emoji:"\1F440"}.header-module--header--2EhlL{--radius:60px;--dim:calc(var(--radius)*2);--position:-10px;background:linear-gradient(var(--dark-sky),var(--light-sky));transition:background .2s ease;color:var(--text-color);overflow:hidden;position:relative}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f{background:radial-gradient(var(--radius) circle at var(--radius) var(--radius),var(--planet-color) 50%,transparent 100%);position:absolute;top:0;right:0;height:var(--dim);width:var(--dim);transition:background,color .2s ease;cursor:pointer;border:0;outline:0;padding:0;font-size:40px;transform:rotate(30deg) translate(10px,-50px);color:transparent}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f:focus,.header-module--header--2EhlL .header-module--toggle-dark--fbF-f:hover{color:#000}.header-module--header--2EhlL .header-module--toggle-dark--fbF-f span:before{content:var(--planet-emoji)}.header-module--header--2EhlL a{color:inherit;box-shadow:none;text-decoration:none;display:inline-flex;align-items:center}.link-module--link--1wSRX{color:var(--link-color);word-break:break-word}.social-nav-module--link--2GvUk{margin:0 5px}.social-nav-module--link--2GvUk svg{width:20px}body.dark-mode .social-nav-module--link--2GvUk svg path{fill:#fff}.footer-module--footer--R2bpz{text-align:center;padding-block:15px;background:#000;box-shadow:0 0 10px #000;color:#b5e853;font-family:monospace}.footer-module--footer--R2bpz:before{content:"";display:block;height:25px;background:radial-gradient(5px circle at 10px 10px,#fe6158 100%,transparent),radial-gradient(5px circle at 27px 10px,#febe2f 100%,transparent),radial-gradient(5px circle at 44px 10px,#28c940 100%,transparent)}.footer-module--footer--R2bpz a,.footer-module--footer--R2bpz a:link,.footer-module--footer--R2bpz a:visited{color:#63c0f5}.layout-module--root--2bezS{display:flex;flex-direction:column;min-height:100vh;color:var(--text-color)}.layout-module--content--15Ymk{flex:1 1;background:linear-gradient(var(--light-sky) calc(100% - 60px),#8ab807 calc(100% - 40px),#563a2c calc(100% - 10px),#563a2c);padding-bottom:30px}.layout-module--content--15Ymk img{max-width:100%}.code-module--line-number-style--2tWK5{display:inline-block;padding-left:1em;padding-right:1em;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.3;text-align:center;position:relative}img+.em-module--em--KE84c,span+.em-module--em--KE84c{display:block;text-align:center;font-size:.9rem;padding-block:4px}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">CompareFolders — a Visual Studio Code extension journey — Part IV | Moshe Feuchtwanger</title><link data-react-helmet="true" rel="icon" type="image/png" href="/static/avatar-e981c1fbc840d15a0caabe830fa5674f.png"/><link data-react-helmet="true" rel="canonical" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3"/><meta data-react-helmet="true" name="google-site-verification" content="hpJ5hHMHz7pz5hEBUsKSCUaVIZg8rMKiQ86uyqVuFw4"/><meta data-react-helmet="true" name="description" content="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…"/><meta data-react-helmet="true" property="og:title" content="CompareFolders — a Visual Studio Code extension journey — Part IV"/><meta data-react-helmet="true" property="og:description" content="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:creator" content="Moshe Feuchtwanger"/><meta data-react-helmet="true" name="twitter:title" content="CompareFolders — a Visual Studio Code extension journey — Part IV"/><meta data-react-helmet="true" name="twitter:description" content="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…"/><meta data-react-helmet="true" name="keywords" content="vscode,vscode-extension,how-to,open-source"/><meta data-react-helmet="true" name="og:image" content="https://moshfeu.github.io/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…"/><meta data-react-helmet="true" name="twitter:image" content="https://moshfeu.github.io/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><link href="https://fonts.googleapis.com/css?family=Roboto:wght@300|Open+Sans&amp;display=swap" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-92c28782d0e1d6ee154a.js"/><link as="script" rel="preload" href="/framework-8e528b732ab2eaadb7b7.js"/><link as="script" rel="preload" href="/app-d2414d5c3ac0e52b02f5.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/commons-6c3618e07be3fa7b913f.js"/><link as="script" rel="preload" href="/component---src-components-post-js-b0ee7c9b4e8a455b7e15.js"/><link as="fetch" rel="preload" href="/page-data/comparefolders-a-visual-studio-code-extension-journey-part-iv/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090755652.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4064581832.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/511549514.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/764694655.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="1g1shso">body{--theme-ui-colors-text:#282c35;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#007acc;--theme-ui-colors-secondary:#1B1F23;--theme-ui-colors-muted:hsla(0,0%,0%,0.2);--theme-ui-colors-highlight:#00ff00;--theme-ui-colors-heading:#282c35;--theme-ui-colors-prism-background:#011627;--theme-ui-colors-prism-comment:#809393;--theme-ui-colors-prism-string:#addb67;--theme-ui-colors-prism-var:#d6deeb;--theme-ui-colors-prism-number:#f78c6c;--theme-ui-colors-prism-constant:#82aaff;--theme-ui-colors-prism-punctuation:#c792ea;--theme-ui-colors-prism-className:#ffc98b;--theme-ui-colors-prism-tag:#ffa7c4;--theme-ui-colors-prism-boolean:#ff5874;--theme-ui-colors-prism-property:#80cbc4;--theme-ui-colors-prism-namespace:#b2ccd6;--theme-ui-colors-prism-highlight:hsla(207,95%,15%,1);color:var(--theme-ui-colors-text,#282c35);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:rgba(255,255,255,0.86);--theme-ui-colors-background:#232129;--theme-ui-colors-primary:#D9BAE8;--theme-ui-colors-secondary:rgba(255,255,255,0.86);--theme-ui-colors-muted:hsla(0,0%,100%,0.2);--theme-ui-colors-highlight:#663399;--theme-ui-colors-heading:#fff;}</style><style data-emotion-css="1rckfa9">*{box-sizing:border-box;}body{margin:0;font-family:Open Sans,Roboto,system-ui,sans-serif;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="1awr4tz">.css-1awr4tz{font-family:Open Sans,Roboto,system-ui,sans-serif;}</style><div class="layout-module--root--2bezS css-1awr4tz"><header class="header-module--header--2EhlL"><style data-emotion-css="f7co1v">.css-f7co1v{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-f7co1v"><style data-emotion-css="rsd53u">.css-rsd53u{margin-top:0;margin-bottom:0;font-size:24px;}</style><div class="css-rsd53u"><a href="/"><style data-emotion-css="1emx3y6">.css-1emx3y6{margin-right:8px;margin-bottom:0;width:48px;min-width:48px;border-radius:99999px;}</style><img src="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png" srcSet="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png 1x,
/static/e981c1fbc840d15a0caabe830fa5674f/e5b88/avatar.png 1.5x,
/static/e981c1fbc840d15a0caabe830fa5674f/88b72/avatar.png 2x" alt="Moshe Feuchtwanger" class="css-1emx3y6"/>Moshe Feuchtwanger</a></div></div><button aria-label="Toggle Dark Mode" class="header-module--toggle-dark--fbF-f"><span></span></button></header><div class="layout-module--content--15Ymk"><style data-emotion-css="1in33uw">.css-1in33uw{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;padding-bottom:32px;}</style><div class="css-1in33uw"><main><article><header><h1 class="css-0">CompareFolders — a Visual Studio Code extension journey — Part IV</h1><style data-emotion-css="1h1xv8c">.css-1h1xv8c{font-size:14px;margin-top:-16px;margin-bottom:16px;}</style><style data-emotion-css="dv5tmu">.css-dv5tmu{font-size:14px;margin-top:-16px;margin-bottom:16px;}.css-dv5tmu code{font-size:inherit;}</style><p class="css-dv5tmu">September 29, 2019</p><div class="css-0"><a href="/tag/vscode"><style data-emotion-css="b8nnxg">.css-b8nnxg{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary,#007acc);margin-left:0;}</style><div class="css-b8nnxg">vscode</div></a><a href="/tag/vscode-extension"><style data-emotion-css="ugeaf6">.css-ugeaf6{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary,#007acc);margin-left:4px;}</style><div class="css-ugeaf6">vscode-extension</div></a><a href="/tag/how-to"><div class="css-ugeaf6">how-to</div></a><a href="/tag/open-source"><div class="css-ugeaf6">open-source</div></a></div></header><style data-emotion-css="164r41r">.css-164r41r{margin-top:8px;}</style><div class="css-164r41r"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:56.231884057971016%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGh+ZTJRGH/xAAZEAACAwEAAAAAAAAAAAAAAAABAgADERL/2gAIAQEAAQUCqRc5EeteqmMLHGY7/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhABAQEAAAAAAAAAAAAAAAAAADEQ/9oACAEBAAY/Akyqr//EABgQAQADAQAAAAAAAAAAAAAAAAEAETEg/9oACAEBAAE/IRYi5jgO5dx//9oADAMBAAIAAwAAABAUP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EEf/xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhcf/aAAgBAQABPxAYgWYDh5a2AQcxReFO2V//2Q==" alt="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/959f5fde34fc36b0be57fdeb0e5ff23b/862d9/0xeKX4RJyX-8sueTl.jpg 345w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/32c8c/0xeKX4RJyX-8sueTl.jpg 690w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg 1380w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/4e1b9/0xeKX4RJyX-8sueTl.jpg 1844w" sizes="(max-width: 1380px) 100vw, 1380px" /><img loading="lazy" sizes="(max-width: 1380px) 100vw, 1380px" srcset="/static/959f5fde34fc36b0be57fdeb0e5ff23b/862d9/0xeKX4RJyX-8sueTl.jpg 345w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/32c8c/0xeKX4RJyX-8sueTl.jpg 690w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg 1380w,
/static/959f5fde34fc36b0be57fdeb0e5ff23b/4e1b9/0xeKX4RJyX-8sueTl.jpg 1844w" src="/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg" alt="In the  last post , we talked about how to add an icon to the activity bar and “attach” a view to it. How to use  TreeDataProvider  to…" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></div><section><style data-emotion-css="1ek8oqb">.css-1ek8oqb code{font-size:inherit;}</style><p class="css-1ek8oqb">In the <a class="link-module--link--1wSRX" href="https://medium.com/@moshfeu/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii-77e0467a12f6?source=friends_link&amp;sk=34deefe0a5a41ce97c6197a5f2813e0f" target="_blank" rel="noopener noreferrer">last post</a>, we talked about how to add an icon to the activity bar and “attach” a view to it. How to use <style data-emotion-css="1lcx0oi">.css-1lcx0oi{border-radius:0.3em;color:var(--theme-ui-colors-secondary,#1B1F23);background-color:var(--theme-ui-colors-highlight,#00ff00);padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-1lcx0oi">TreeDataProvider</code> to present File System like view to show the diffs like files in directories.</p><p class="css-1ek8oqb">Like promised, the post will includes an explanation about the product challenge and how to solve it.</p><style data-emotion-css="h7w91b">.css-h7w91b{pointer-events:painted;}.css-h7w91b a{visibility:hidden;}.css-h7w91b:hover a{visibility:visible;}</style><h2 class="css-h7w91b"><style data-emotion-css="vvm4x1">.css-vvm4x1{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary,#007acc);}</style><a href="#undefined" aria-label="The Challenge" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Challenge</h2><p class="css-1ek8oqb">In the last post, the extension was able to show only single hierarchy of differences. Means if a deep folder has differences the extension wasn’t be able to show it. This challenge, obviously, is not a vscode extension specifically but I splatted the commits so this refactor will “get” its own commit to isolate the logic and maybe will help to someone else with such task.</p><p class="css-1ek8oqb">Back to the series’ format — vscode extension challenges, the extension should allow the users to refresh the folders view after some change has been made in a file / folder. So we’ll add a button to the panel’s “top bar” and when the user will click on it, the compare logic will run again and will refresh the view. Once the view refreshed, the extension will show an information popup about that.</p><p class="css-1ek8oqb"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:674px">
      <a class="link-module--link--1wSRX" href="/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:15%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVQI1z2N/Q6CMAzEef/HUqJxHwY31AgKy7YWWuY7WCR6Sdu76x+/ipkBMeecUsqrIMYUYwQACYhIiItRVO/Y6hCCNNNPVSml63pjrFKmaS7OteK1Nt5fnfP9MJZxoMO+f77ex7o925gSAghpnudKyHKI6L/5qy2ujcz9tugTd4+JSIDbS8wHJDGdubpWiaUAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="A “top bar” button in the source control panel" title="A “top bar” button in the source control panel" src="/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png" srcSet="/static/1d35c479321e2c2a4791725f20c55120/5a46d/1a7jbpEvrTNYFQwOO0pgyuQ.png 300w,/static/1d35c479321e2c2a4791725f20c55120/0a47e/1a7jbpEvrTNYFQwOO0pgyuQ.png 600w,/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png 674w" sizes="(max-width: 674px) 100vw, 674px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span><em class="em-module--em--KE84c">A “top bar” button in the source control panel</em></p><p class="css-1ek8oqb">So</p><h2 class="css-h7w91b"><a href="#undefined" aria-label="How to display a button in a view’s top bar?" class="css-vvm4x1"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to display a button in a view’s top bar?</h2><p class="css-1ek8oqb">In order to display a button we need some steps: We need to add the button as a “contributer” in the <code class="css-1lcx0oi">contributes</code> section and specify the command that we want to run when it clicked. Therefore, we need to add that command to the <code class="css-1lcx0oi">commands</code> section, also in the <em class="em-module--em--KE84c">package.json.</em> And finally, we need to register that command in the extension’s activation call.</p><p class="css-1ek8oqb"><strong class="css-0">Step 1</strong></p><p class="css-1ek8oqb">Add the “refresh” command in the <code class="css-1lcx0oi">commands</code> section in <em class="em-module--em--KE84c">package.json</em></p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;commands&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  ...</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;title&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">5</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;command&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;foldersCompare.refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">6</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;icon&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;resources/refresh.svg&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">7</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">8</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></pre></div><p class="css-1ek8oqb"><strong class="css-0">Step 2</strong></p><p class="css-1ek8oqb">Add the “refresh” button in the top bar in the <code class="css-1lcx0oi">contributes-&amp;gt;menus</code> section in <em class="em-module--em--KE84c">package.json</em></p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;contributes&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  ...</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;menus&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;view/title&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">5</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;command&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;foldersCompare.refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">6</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;group&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;navigation&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">7</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">8</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb"><code class="css-1lcx0oi">command</code> is the key of the command and <code class="css-1lcx0oi">group</code> is the place we want to present the button inside the top bar. By default it will be presented under the “more” menu:</p><p class="css-1ek8oqb"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:926px">
      <a class="link-module--link--1wSRX" href="/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:18%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVQI11XOSW7EIBAFUN//TJlW6fZEgw24ymXAbYYGFlnkBLGUlqKU3uL/1a9mow0RYQFaSSmltbbGIICcpbO21lJKfqqlel+HNnfXr9t4/RCNXC1TKIBmNBMaSVaRm2A7qza7S8XG/JTKvR/2+3HkHEvp/XdjneuGUcMq9aIBx5uYZj1ycYb4yH/SI53DXRvdzpE+mQC7NxutnHMpFWMseB9CiL8XQsn5n/N174/2Qq8vy9t76rsfWCbOhn0B5GEAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="1SyNphHDTYWiX0ze 97vaJQ" title="1SyNphHDTYWiX0ze 97vaJQ" src="/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png" srcSet="/static/e08ca02f46109b265fbcd070bb401f39/5a46d/1SyNphHDTYWiX0ze-97vaJQ.png 300w,/static/e08ca02f46109b265fbcd070bb401f39/0a47e/1SyNphHDTYWiX0ze-97vaJQ.png 600w,/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png 926w" sizes="(max-width: 926px) 100vw, 926px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><p class="css-1ek8oqb"><strong class="css-0">Step 3</strong></p><p class="css-1ek8oqb">Register the command in the extension’s activation call</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">activate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token maybe-class-name">ExtensionContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  </span><span class="token spread operator" style="color:rgb(127, 219, 202)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">  commands</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">registerCommand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">REFRESH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> foldersCompareProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">refresh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb"><strong class="css-0">Step 4</strong></p><p class="css-1ek8oqb">Finally, we need to implement the “refresh” functionality and ask vscode refresh the view.</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">1</span><span class="token plain">refresh </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">void</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">2</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">3</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/*</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">4</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     get (from memory) the current path of the compared folder</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">5</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     and do the comparison again</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">6</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">    */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">7</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">_diffs</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">compare</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">workspaceRoot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getComparedPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">8</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// ask vscode to refresh to view</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">9</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">_onDidChangeTreeData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">fire</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">10</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// show a message to the user</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">11</span><span class="token plain">    </span><span class="token dom variable" style="color:rgb(214, 222, 235)">window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">showInformationMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Source refreshed&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Dismiss&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">12</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">13</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">14</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--2tWK5">15</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb">Notice that the <code class="css-1lcx0oi">onDidChangeTreeData.fire</code> event shouldn’t call with arguments, otherwise, none of the functions (<code class="css-1lcx0oi">getChildren</code> not <code class="css-1lcx0oi">getTreeItem</code>) will be fired.</p><p class="css-1ek8oqb">Notice also that the <code class="css-1lcx0oi">refresh</code> method declared as an arrow function to bind it to the <code class="css-1lcx0oi">foldersCompareProvider</code> instance. When vscode will invoke that function it will run in the context of the instance (Is that clear enough?)</p><p class="css-1ek8oqb">Finally, we want to show an information message with a “dismiss” button to let them know that the sourced refreshed (in case the change in deep path and not visible in the UI right away)</p><p class="css-1ek8oqb">And this is the result</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F6208d7IZMpo%3Ffeature%3Doembed&amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D6208d7IZMpo&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F6208d7IZMpo%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="100%" height="480"></iframe><p class="css-1ek8oqb"><a class="link-module--link--1wSRX" href="https://github.com/moshfeu/vscode-compare-folders/tree/ccf0b516b6a9eb9c1590d69580baaede0102582f" target="_blank" rel="noopener noreferrer">Source code for this post</a></p><p class="css-1ek8oqb">Have something to say? I’ll love to 👂</p><a class="link-module--link--1wSRX" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3" target="_blank" rel="noopener noreferrer">Original Post</a></section></article></main></div></div><footer class="footer-module--footer--R2bpz"><style data-emotion-css="1jso6df">.css-1jso6df{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:8px;}</style><style data-emotion-css="5l21x5">.css-5l21x5{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:8px;}</style><ul class="css-5l21x5"><li><a rel="prev" href="/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii/">← <!-- -->CompareFolders — a Visual Studio Code extension journey — Part III</a></li><li><a rel="next" href="/comparefolders-a-visual-studio-code-extension-journey-part-v/">CompareFolders — a Visual Studio Code extension journey — Part V<!-- --> →</a></li></ul>© <!-- -->2021<!-- --> - Moshe Feuchtwander</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-118358576-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-118358576-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/comparefolders-a-visual-studio-code-extension-journey-part-iv/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-7f1ec355261b605a652a.js"],"app":["/app-d2414d5c3ac0e52b02f5.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-0c92d56c64475ee870d4.js"],"component---src-components-post-js":["/component---src-components-post-js-b0ee7c9b4e8a455b7e15.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d74e58afe1d3f1eebccb.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-77c6399ff00a0d66286b.js"]};/*]]>*/</script><script src="/polyfill-7f1ec355261b605a652a.js" nomodule=""></script><script src="/component---src-components-post-js-b0ee7c9b4e8a455b7e15.js" async=""></script><script src="/commons-6c3618e07be3fa7b913f.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-d2414d5c3ac0e52b02f5.js" async=""></script><script src="/framework-8e528b732ab2eaadb7b7.js" async=""></script><script src="/webpack-runtime-92c28782d0e1d6ee154a.js" async=""></script></body></html>