<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.9"/><meta data-react-helmet="true" name="google-site-verification" content="hpJ5hHMHz7pz5hEBUsKSCUaVIZg8rMKiQ86uyqVuFw4"/><meta data-react-helmet="true" name="description" content="In the  last post , we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use  TreeDataProvider  to‚Ä¶"/><meta data-react-helmet="true" property="og:title" content="CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart IV"/><meta data-react-helmet="true" property="og:description" content="In the  last post , we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use  TreeDataProvider  to‚Ä¶"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:creator" content="Moshe Feuchtwanger"/><meta data-react-helmet="true" name="twitter:title" content="CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart IV"/><meta data-react-helmet="true" name="twitter:description" content="In the  last post , we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use  TreeDataProvider  to‚Ä¶"/><meta data-react-helmet="true" name="keywords" content="vscode,vscode-extension,how-to,open-source"/><meta data-react-helmet="true" name="og:image" content="https://moshfeu.github.io/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="In the  last post , we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use  TreeDataProvider  to‚Ä¶"/><meta data-react-helmet="true" name="twitter:image" content="https://moshfeu.github.io/static/959f5fde34fc36b0be57fdeb0e5ff23b/a674a/0xeKX4RJyX-8sueTl.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="In the  last post , we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use  TreeDataProvider  to‚Ä¶"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><style data-href="/styles.9c423fcc01d89e273043.css" data-identity="gatsby-global-css">:root{--reach-skip-nav:1}[data-reach-skip-nav-link]{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}[data-reach-skip-nav-link]:focus{clip:auto;background:#fff;height:auto;left:10px;padding:1rem;position:fixed;top:10px;width:auto;z-index:1}.link-module--link--bd3ac{color:var(--link-color);word-break:break-word}body{font-size:18px;line-height:1.5}body:not(.dark-mode){--dark-sky:#53bde6;--light-sky:#cdfdff;--planet-color:#ffe130;--link-color:#007acc;--text-color:inherit;--planet-emoji:"üï∂Ô∏è"}body.dark-mode{--dark-sky:#000;--light-sky:#122627;--planet-color:#fff;--link-color:#ffeb00;--text-color:#fffee9;--planet-emoji:"üëÄ"}video{width:100%}.header-module--header--1a727{--radius:60px;--dim:calc(var(--radius)*2);--position:-10px;background:linear-gradient(var(--dark-sky),var(--light-sky));color:var(--text-color);overflow:hidden;position:relative;transition:background .2s ease}.header-module--header--1a727 .header-module--toggle-dark--3b11c{background:radial-gradient(var(--radius) circle at var(--radius) var(--radius),var(--planet-color) 50%,transparent 100%);border:0;color:transparent;cursor:pointer;font-size:40px;height:var(--dim);outline:0;padding:0;position:absolute;right:0;top:0;transform:rotate(30deg) translate(10px,-50px);transition:background,color .2s ease;width:var(--dim)}.header-module--header--1a727 .header-module--toggle-dark--3b11c:focus,.header-module--header--1a727 .header-module--toggle-dark--3b11c:hover{color:#000}.header-module--header--1a727 .header-module--toggle-dark--3b11c span:before{content:var(--planet-emoji)}.header-module--header--1a727 a{align-items:center;box-shadow:none;color:inherit;display:inline-flex;text-decoration:none}.social-nav-module--link--a1fb1{margin:0 5px}.social-nav-module--link--a1fb1 svg{width:20px}body.dark-mode .social-nav-module--link--a1fb1 svg path{fill:#fff}.footer-module--footer--675c6{background:#000;box-shadow:0 0 10px #000;color:#b5e853;font-family:monospace;padding-block:15px;text-align:center}.footer-module--footer--675c6:before{background:radial-gradient(5px circle at 10px 10px,#fe6158 100%,transparent),radial-gradient(5px circle at 27px 10px,#febe2f 100%,transparent),radial-gradient(5px circle at 44px 10px,#28c940 100%,transparent);content:"";display:block;height:25px}.footer-module--footer--675c6 a,.footer-module--footer--675c6 a:link,.footer-module--footer--675c6 a:visited{color:#63c0f5}.footer-module--footer--675c6 .footer-module--no-copyright--7d572{vertical-align:middle}.layout-module--root--65bca{color:var(--text-color);display:flex;flex-direction:column;min-height:100vh}.layout-module--content--e6f14{background:linear-gradient(var(--light-sky) calc(100% - 60px),#8ab807 calc(100% - 40px),#563a2c calc(100% - 10px),#563a2c 100%);flex:1 1;padding-bottom:30px}.layout-module--content--e6f14 img{max-width:100%}.code-module--line-number-style--5b2b0{display:inline-block;opacity:.3;padding-left:1em;padding-right:1em;position:relative;text-align:center;-webkit-user-select:none;user-select:none}img+.em-module--em--86c77,span+.em-module--em--86c77{display:block;font-size:.9rem;padding-block:4px;text-align:center}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart IV | Moshe Feuchtwanger</title><link data-react-helmet="true" rel="icon" type="image/png" href="/static/avatar-ff57f6a40c8eadde26a1de94865ca765.png"/><link data-react-helmet="true" rel="canonical" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3"/><link href="https://fonts.googleapis.com/css?family=Roboto:wght@300|Open+Sans&amp;display=swap" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1sbp79x">body{--theme-ui-colors-text:#282c35;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#007acc;--theme-ui-colors-secondary:#1B1F23;--theme-ui-colors-muted:hsla(0, 0%, 0%, 0.2);--theme-ui-colors-highlight:#00ff00;--theme-ui-colors-heading:#282c35;--theme-ui-colors-prism-background:#011627;--theme-ui-colors-prism-comment:#809393;--theme-ui-colors-prism-string:#addb67;--theme-ui-colors-prism-var:#d6deeb;--theme-ui-colors-prism-number:#f78c6c;--theme-ui-colors-prism-constant:#82aaff;--theme-ui-colors-prism-punctuation:#c792ea;--theme-ui-colors-prism-className:#ffc98b;--theme-ui-colors-prism-tag:#ffa7c4;--theme-ui-colors-prism-boolean:#ff5874;--theme-ui-colors-prism-property:#80cbc4;--theme-ui-colors-prism-namespace:#b2ccd6;--theme-ui-colors-prism-highlight:hsla(207, 95%, 15%, 1);color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}body.theme-ui-dark{--theme-ui-colors-text:rgba(255, 255, 255, 0.86);--theme-ui-colors-background:#232129;--theme-ui-colors-primary:#D9BAE8;--theme-ui-colors-secondary:rgba(255, 255, 255, 0.86);--theme-ui-colors-muted:hsla(0, 0%, 100%, 0.2);--theme-ui-colors-highlight:#663399;--theme-ui-colors-heading:#fff;}</style><style data-emotion="css-global 1rckfa9">*{box-sizing:border-box;}body{margin:0;font-family:Open Sans,Roboto,system-ui,sans-serif;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--root--65bca"><header class="header-module--header--1a727"><style data-emotion="css 13xn1c7">.css-13xn1c7{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width: 40em){.css-13xn1c7{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><div class="css-13xn1c7"><style data-emotion="css 1y5dmvz">.css-1y5dmvz{margin-top:0;margin-bottom:0;font-size:24px;}</style><style data-emotion="css 1qasgcb">.css-1qasgcb{box-sizing:border-box;margin:0;min-width:0;margin-top:0;margin-bottom:0;font-size:24px;}</style><div class="css-1qasgcb"><a href="/"><style data-emotion="css 19ns1mg">.css-19ns1mg{margin-right:8px;margin-bottom:0;width:48px;min-width:48px;border-radius:99999px;}</style><img src="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png" srcSet="/static/e981c1fbc840d15a0caabe830fa5674f/aff39/avatar.png 1x,
/static/e981c1fbc840d15a0caabe830fa5674f/e5b88/avatar.png 1.5x,
/static/e981c1fbc840d15a0caabe830fa5674f/88b72/avatar.png 2x" alt="Moshe Feuchtwanger" class="css-19ns1mg"/>Moshe Feuchtwanger</a></div></div><button aria-label="Toggle Dark Mode" class="header-module--toggle-dark--3b11c"><span></span></button></header><div class="layout-module--content--e6f14"><style data-emotion="css 1in33uw">.css-1in33uw{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;padding-bottom:32px;}</style><div class="css-1in33uw"><main><article><header><h1 class="css-0">CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart IV</h1><style data-emotion="css rsra4b">.css-rsra4b{font-size:14px;margin-top:-16px;margin-bottom:16px;}</style><style data-emotion="css 1jnjfic">.css-1jnjfic{font-size:14px;margin-top:-16px;margin-bottom:16px;}.css-1jnjfic code{font-size:inherit;}</style><p class="css-1jnjfic">September 29, 2019</p><style data-emotion="css lgbo0i">.css-lgbo0i{box-sizing:border-box;margin:0;min-width:0;}</style><div class="css-lgbo0i"><a href="/tag/vscode"><style data-emotion="css 21clv8">.css-21clv8{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary);margin-left:0;}</style><div class="css-21clv8">vscode</div></a><a href="/tag/vscode-extension"><style data-emotion="css 8rl423">.css-8rl423{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:12px;font-weight:bold;white-space:nowrap;padding-left:4px;padding-right:4px;border-radius:2px;color:white;background-color:var(--theme-ui-colors-primary);margin-left:4px;}</style><div class="css-8rl423">vscode-extension</div></a><a href="/tag/how-to"><div class="css-8rl423">how-to</div></a><a href="/tag/open-source"><div class="css-8rl423">open-source</div></a></div></header><style data-emotion="css 164r41r">.css-164r41r{margin-top:8px;}</style><div class="css-164r41r"></div><section><style data-emotion="css 1ek8oqb">.css-1ek8oqb code{font-size:inherit;}</style><p class="css-1ek8oqb">In the <a class="link-module--link--bd3ac" href="https://medium.com/@moshfeu/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii-77e0467a12f6?source=friends_link&amp;sk=34deefe0a5a41ce97c6197a5f2813e0f" target="_blank" rel="noopener noreferrer">last post</a>, we talked about how to add an icon to the activity bar and ‚Äúattach‚Äù a view to it. How to use <style data-emotion="css 118aluo">.css-118aluo{border-radius:0.3em;color:var(--theme-ui-colors-secondary);background-color:var(--theme-ui-colors-highlight);padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-118aluo">TreeDataProvider</code> to present File System like view to show the diffs like files in directories.</p><p class="css-1ek8oqb">Like promised, the post will includes an explanation about the product challenge and how to solve it.</p><style data-emotion="css 17gfwuz">.css-17gfwuz{pointer-events:painted;}.css-17gfwuz a{visibility:hidden;}.css-17gfwuz:hover a{visibility:visible;}</style><h2 class="css-17gfwuz"><style data-emotion="css yixlj4">.css-yixlj4{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary);}</style><a href="#undefined" aria-label="The Challenge" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Challenge</h2><p class="css-1ek8oqb">In the last post, the extension was able to show only single hierarchy of differences. Means if a deep folder has differences the extension wasn‚Äôt be able to show it. This challenge, obviously, is not a vscode extension specifically but I splatted the commits so this refactor will ‚Äúget‚Äù its own commit to isolate the logic and maybe will help to someone else with such task.</p><p class="css-1ek8oqb">Back to the series‚Äô format ‚Äî vscode extension challenges, the extension should allow the users to refresh the folders view after some change has been made in a file / folder. So we‚Äôll add a button to the panel‚Äôs ‚Äútop bar‚Äù and when the user will click on it, the compare logic will run again and will refresh the view. Once the view refreshed, the extension will show an information popup about that.</p><p class="css-1ek8oqb"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:674px">
      <a class="link-module--link--bd3ac" href="/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:15%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVQI1z2N2w6CMBBE+f/PUqKRtgYLaAQF0r20u9R/UCR6HiaZMw9TqCoxIyIA4AqFACEEIkJEZhbmxVZS7tSZeZ6ZOf4ocs59P1jrqsrW9cX71lpnjG2azvtmGKc8jXLYD4/n61i2ZxcAmAgAUkqFqqaUROSf+mWrqxGR23UxJ+3vUSTGuE2f5zckMZ250DOD6QAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="A ‚Äútop bar‚Äù button in the source control panel" title="A ‚Äútop bar‚Äù button in the source control panel" src="/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png" srcSet="/static/1d35c479321e2c2a4791725f20c55120/5a46d/1a7jbpEvrTNYFQwOO0pgyuQ.png 300w,/static/1d35c479321e2c2a4791725f20c55120/0a47e/1a7jbpEvrTNYFQwOO0pgyuQ.png 600w,/static/1d35c479321e2c2a4791725f20c55120/fdaf8/1a7jbpEvrTNYFQwOO0pgyuQ.png 674w" sizes="(max-width: 674px) 100vw, 674px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span><em class="em-module--em--86c77">A ‚Äútop bar‚Äù button in the source control panel</em></p><p class="css-1ek8oqb">So</p><h2 class="css-17gfwuz"><a href="#undefined" aria-label="How to display a button in a view‚Äôs top bar?" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to display a button in a view‚Äôs top bar?</h2><p class="css-1ek8oqb">In order to display a button we need some steps: We need to add the button as a ‚Äúcontributer‚Äù in the <code class="css-118aluo">contributes</code> section and specify the command that we want to run when it clicked. Therefore, we need to add that command to the <code class="css-118aluo">commands</code> section, also in the <em class="em-module--em--86c77">package.json.</em> And finally, we need to register that command in the extension‚Äôs activation call.</p><p class="css-1ek8oqb"><strong class="css-0">Step 1</strong></p><p class="css-1ek8oqb">Add the ‚Äúrefresh‚Äù command in the <code class="css-118aluo">commands</code> section in <em class="em-module--em--86c77">package.json</em></p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;commands&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">2</span><span class="token plain">  ...</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">3</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">4</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;title&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">5</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;command&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;foldersCompare.refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">6</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;icon&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;resources/refresh.svg&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">7</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">8</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></pre></div><p class="css-1ek8oqb"><strong class="css-0">Step 2</strong></p><p class="css-1ek8oqb">Add the ‚Äúrefresh‚Äù button in the top bar in the <code class="css-118aluo">contributes-&amp;gt;menus</code> section in <em class="em-module--em--86c77">package.json</em></p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">1</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;contributes&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">2</span><span class="token plain">  ...</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">3</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;menus&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">4</span><span class="token plain">    </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;view/title&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">5</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;command&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;foldersCompare.refresh&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">6</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;group&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;navigation&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">7</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">8</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb"><code class="css-118aluo">command</code> is the key of the command and <code class="css-118aluo">group</code> is the place we want to present the button inside the top bar. By default it will be presented under the  ‚Äúmore‚Äù menu:</p><p class="css-1ek8oqb"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:926px">
      <a class="link-module--link--bd3ac" href="/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:18%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQI11XCy3LCIBQA0Pz/N1XblZoHBBIg3BAghodcFi78Ahd1ptMzp9nMBgB60WY1UkqllLMWtBaz8M7Viojls2INoQ5t6W7Pkdx+eCNWRyVwbWawE1hhnDR+0tsMVtndZ3SpfGa898N+P45SEmIfXo3zvhuI0qtQi9JARj7NijBORp4e5W9+ZKyha5PfGZgL5drtzWZWxpgQklIaQ4gxpl8xYin/IpYQjvZqTl/L+Tv33RtYJs6GVhIMjgAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="1SyNphHDTYWiX0ze 97vaJQ" title="1SyNphHDTYWiX0ze 97vaJQ" src="/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png" srcSet="/static/e08ca02f46109b265fbcd070bb401f39/5a46d/1SyNphHDTYWiX0ze-97vaJQ.png 300w,/static/e08ca02f46109b265fbcd070bb401f39/0a47e/1SyNphHDTYWiX0ze-97vaJQ.png 600w,/static/e08ca02f46109b265fbcd070bb401f39/69476/1SyNphHDTYWiX0ze-97vaJQ.png 926w" sizes="(max-width: 926px) 100vw, 926px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p class="css-1ek8oqb"><strong class="css-0">Step 3</strong></p><p class="css-1ek8oqb">Register the command in the extension‚Äôs activation call</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">activate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> ExtensionContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">2</span><span class="token plain">  </span><span class="token operator" style="color:rgb(127, 219, 202)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">3</span><span class="token plain">  commands</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">registerCommand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">REFRESH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> foldersCompareProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">refresh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">4</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb"><strong class="css-0">Step 4</strong></p><p class="css-1ek8oqb">Finally, we need to implement the ‚Äúrefresh‚Äù functionality and ask vscode refresh the view.</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627;overflow-x:auto"><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">1</span><span class="token plain">refresh </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">2</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">3</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/*</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">4</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     get (from memory) the current path of the compared folder</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">5</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     and do the comparison again</span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">6</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">    */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">7</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">_diffs </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">compare</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">workspaceRoot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getComparedPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">8</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// ask vscode to refresh to view</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">9</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">_onDidChangeTreeData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">fire</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">10</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// show a message to the user</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">11</span><span class="token plain">    window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">showInformationMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Source refreshed&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Dismiss&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">12</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">13</span><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">14</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="code-module--line-number-style--5b2b0">15</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p class="css-1ek8oqb">Notice that the <code class="css-118aluo">onDidChangeTreeData.fire</code> event shouldn‚Äôt call with arguments, otherwise, none of the functions (<code class="css-118aluo">getChildren</code> not <code class="css-118aluo">getTreeItem</code>) will be fired.</p><p class="css-1ek8oqb">Notice also that the <code class="css-118aluo">refresh</code> method declared as an arrow function to bind it to the <code class="css-118aluo">foldersCompareProvider</code> instance. When vscode will invoke that function it will run in the context of the instance (Is that clear enough?)</p><p class="css-1ek8oqb">Finally, we want to show an information message with a ‚Äúdismiss‚Äù button to let them know that the sourced refreshed (in case the change in deep path and not visible in the UI right away)</p><p class="css-1ek8oqb">And this is the result</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F6208d7IZMpo%3Ffeature%3Doembed&amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D6208d7IZMpo&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F6208d7IZMpo%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="100%" height="480"></iframe><p class="css-1ek8oqb"><a class="link-module--link--bd3ac" href="https://github.com/moshfeu/vscode-compare-folders/tree/ccf0b516b6a9eb9c1590d69580baaede0102582f" target="_blank" rel="noopener noreferrer">Source code for this post</a></p><p class="css-1ek8oqb">Have something to say? I‚Äôll love to üëÇ</p><a class="link-module--link--bd3ac" href="https://moshfeu.medium.com/comparefolders-a-visual-studio-code-extension-journey-part-iv-a26264e841a3" target="_blank" rel="noopener noreferrer">Original Post</a></section></article></main></div></div><footer class="footer-module--footer--675c6"><style data-emotion="css 1jso6df">.css-1jso6df{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;list-style:none;padding:8px;}</style><style data-emotion="css diw1ju">.css-diw1ju{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;list-style:none;padding:8px;}</style><ul class="css-diw1ju"><li><a rel="prev" href="/he-activity-comparefolders-a-visual-studio-code-extension-journey-part-ii/">‚Üê <!-- -->CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart III</a></li><li><a rel="next" href="/comparefolders-a-visual-studio-code-extension-journey-part-v/">CompareFolders‚Ää‚Äî‚Ääa Visual Studio Code extension journey‚Ää‚Äî‚ÄäPart V<!-- --> ‚Üí</a></li></ul><span class="footer-module--no-copyright--7d572" title="No Copyright Intended"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve" width="20" height="20" fill="#b5e853"><g><path d="M0,256c0.02,141.39,114.61,255.98,256,256c141.39-0.02,255.98-114.61,256-256C511.98,114.61,397.39,0.02,256,0   C114.61,0.02,0.02,114.61,0,256c0,14.14,11.46,25.6,25.6,25.6s25.6-11.46,25.6-25.6c0.01-56.64,22.88-107.67,59.98-144.82   C148.33,74.08,199.36,51.21,256,51.2c56.63,0.01,107.67,22.88,144.82,59.98c37.1,37.14,59.97,88.18,59.98,144.82   c-0.01,56.63-22.88,107.67-59.98,144.82c-37.14,37.1-88.18,59.97-144.82,59.98c-56.64-0.01-107.67-22.88-144.82-59.98   C74.08,363.67,51.21,312.64,51.2,256c0-14.14-11.46-25.6-25.6-25.6S0,241.86,0,256L0,256z"></path><path d="M324.1,179.17c-19.42-17.08-43.77-25.61-67.85-25.58c-26.93-0.03-53.98,10.63-74.06,31.48l0,0   c-19.04,19.74-28.64,45.44-28.62,70.94c-0.03,25.49,9.58,51.2,28.62,70.94l0,0c20.08,20.85,47.13,31.51,74.06,31.48   c24.08,0.02,48.43-8.5,67.85-25.58c10.62-9.33,11.66-25.51,2.33-36.13c-9.33-10.62-25.51-11.66-36.13-2.33   c-9.84,8.64-21.87,12.82-34.05,12.84c-13.64-0.03-27.03-5.27-37.19-15.8l0,0c-9.57-9.94-14.26-22.57-14.28-35.41   c0.03-12.84,4.72-25.47,14.28-35.41l0,0c10.16-10.53,23.55-15.78,37.19-15.8c12.19,0.02,24.21,4.21,34.05,12.84   c10.62,9.33,26.8,8.29,36.13-2.33C335.76,204.68,334.72,188.5,324.1,179.17L324.1,179.17z"></path><path d="M84.3,120.5l38.4,38.4c10,10,26.21,10,36.2,0c10-10,10-26.21,0-36.2l-38.4-38.4c-10-10-26.21-10-36.2,0   S74.3,110.5,84.3,120.5"></path><path d="M353.1,389.3l38.4,38.4c10,10,26.21,10,36.2,0c10-10,10-26.21,0-36.2l-38.4-38.4c-10-10-26.21-10-36.2,0   S343.1,379.3,353.1,389.3"></path></g></svg></span> <!-- -->2026<!-- --> - Moshe Feuchtwanger</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-118358576-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-118358576-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/comparefolders-a-visual-studio-code-extension-journey-part-iv/";window.___webpackCompilationHash="32a63582809edb8b3488";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-c36d90ce4a49d54da991.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-ceb13f80f566e4cd42ed.js"],"component---src-components-post-js":["/component---src-components-post-js-6709b8098da66a2f4c52.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4d725be78be32f2431c8.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-1adffd399be1b88f9c9a.js"]};/*]]>*/</script><script src="/app-c36d90ce4a49d54da991.js" async=""></script><script src="/framework-4b792b97593cf52a3906.js" async=""></script><script src="/webpack-runtime-21f07d3f8a0b161dacb0.js" async=""></script></body></html>